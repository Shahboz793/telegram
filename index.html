<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>ONLINE MAGAZIN YANGIOBOD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="theme-color" content="#0f172a" />

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- HEADER -->
  <header class="header">
    <div class="header-row">
      <div class="logo-wrap">
        <div class="logo-circle"><span>YM</span></div>
        <div class="logo-text">
          <strong>ONLINE MAGAZIN YANGIOBOD</strong>
          <small id="customerInfoText">Hozircha ism va telefon saqlanmagan.</small>
        </div>
      </div>

      <div class="header-right">
        <button class="theme-toggle" id="themeToggleBtn">ğŸŒ™</button>

        <button class="cart-icon-btn" onclick="toggleCartSheet(true)">
          <div class="cart-icon-left">ğŸ›’</div>
          <div class="cart-icon-info">
            <strong><span id="cartCountTop">0</span> ta</strong>
            <small id="cartTotalTop">0 soâ€˜m</small>
          </div>
        </button>

        <button class="admin-access" id="adminAccessBtn">ğŸ‘‘ Admin</button>
      </div>
    </div>

    <div class="tabs" id="tabs">
      <button class="tab-btn active" data-page="shopPage">ğŸ› Magazin</button>
      <button class="tab-btn" data-page="historyPage">ğŸ“œ Buyurtmalar</button>
      <button class="tab-btn hidden" id="adminTabBtn" data-page="adminPage">âš™ï¸ Admin</button>
    </div>
  </header>

  <!-- SHOP PAGE -->
  <main id="shopPage">
    <section class="hero">
      <h1 class="hero-title">Telegram orqali <span>tezkor buyurtma</span></h1>
      <p class="hero-sub">Mahsulotlarni tanlang va Telegramga yuboring.</p>

      <div class="hero-badges">
        <div class="badge">âš¡ Tezkor</div>
        <div class="badge">ğŸ“¦ Qulay savat</div>
        <div class="badge">ğŸ“² WebApp</div>
      </div>

      <p class="hero-note">Ism va telefonni tahrirlash uchun yuqoridagi matnga bosing.</p>

      <div class="search-bar">
        <span>ğŸ”</span>
        <input id="searchInput" type="text" placeholder="Qidiruv..." />
      </div>
    </section>

    <!-- FILTER -->
    <div class="filters-wrapper">
      <div class="filters" id="filterBar"></div>
    </div>

    <!-- PRODUCTS -->
    <section class="products-wrap">
      <div class="products-grid" id="productsGrid"></div>
    </section>
  </main>

  <!-- HISTORY -->
  <section id="historyPage" class="page hidden">
    <h2 class="page-title">ğŸ“œ Buyurtmalar tarixi</h2>
    <p class="page-sub">Tarix saqlanmaydi. Buyurtmalar faqat Telegramga ketadi.</p>
    <div id="historyList"></div>
  </section>

  <!-- ADMIN PAGE -->
  <section id="adminPage" class="page hidden">
    <h2 class="page-title">âš™ï¸ Admin panel</h2>

    <div class="admin-form">
      <h3>â• Mahsulot qoâ€˜shish / tahrirlash</h3>

      <div class="form-row">
        <label>Mahsulot nomi</label>
        <input id="adminName" type="text" />
      </div>

      <div class="form-row">
        <label>Kategoriya</label>
        <select id="adminCategory"></select>
      </div>

      <div class="form-row">
        <label>Asosiy narx</label>
        <input id="adminPriceBase" type="number" />
      </div>

      <div class="admin-check-row">
        <input id="adminHasDiscount" type="checkbox" />
        <label>Chegirma bor</label>
      </div>

      <div class="form-row">
        <label>Chegirma narxi</label>
        <input id="adminPriceDiscount" type="number" />
      </div>

      <div class="form-row">
        <label>Tag</label>
        <input id="adminTag" type="text" />
      </div>

      <div class="form-row">
        <label>Tavsif</label>
        <textarea id="adminDescription"></textarea>
      </div>

      <div class="form-row">
        <label>Rasm URL (vergul bilan)</label>
        <input id="adminImages" type="text" />
      </div>

      <button class="admin-btn" onclick="addCustomProduct()">ğŸ’¾ Saqlash</button>
    </div>

    <h3 class="admin-list-title">ğŸ§¾ Mahsulotlar</h3>
    <div id="adminCustomList"></div>

    <div class="admin-form">
      <h3>ğŸ“‚ Kategoriya qoâ€˜shish</h3>

      <div class="form-row">
        <label>Kategoriya kodi</label>
        <input id="adminCatCode" type="text" />
      </div>

      <div class="form-row">
        <label>Kategoriya nomi</label>
        <input id="adminCatLabel" type="text" />
      </div>

      <div class="form-row">
        <label>Emoji</label>
        <input id="adminCatEmoji" type="text" />
      </div>

      <button class="admin-btn" onclick="saveCategory()">ğŸ’¾ Saqlash</button>
    </div>

    <h3 class="admin-list-title">ğŸ“ Kategoriyalar</h3>
    <div id="adminCategoryList"></div>
  </section>

  <!-- CART OVERLAY -->
  <div class="sheet-overlay" id="cartSheetOverlay" onclick="toggleCartSheet(false)"></div>

  <div class="cart-sheet" id="cartSheet">
    <div class="cart-sheet-header">
      <h3>Savat</h3>
      <button onclick="toggleCartSheet(false)">âœ•</button>
    </div>

    <div class="cart-sheet-body" id="cartItems"></div>

    <div class="cart-sheet-footer">
      <div class="cart-sheet-footer-top">
        <span>Umumiy summa</span>
        <strong id="cartSheetTotal">0 soâ€˜m</strong>
      </div>

      <button class="cart-sheet-btn" onclick="sendOrder()">ğŸ“² Buyurtmani yuborish</button>
    </div>
  </div>

  <!-- PRODUCT DETAIL -->
  <div class="product-detail-overlay hidden" id="productDetailOverlay">
    <div class="product-detail-card">
      <div class="product-detail-header">
        <div class="product-detail-image-wrap">
          <img id="detailImage" src="" />
          <button class="detail-gallery-btn left" id="detailPrevBtn">â€¹</button>
          <button class="detail-gallery-btn right" id="detailNextBtn">â€º</button>
          <div class="detail-image-index" id="detailImageIndex">1 / 1</div>
        </div>
        <button class="product-detail-close" onclick="closeProductDetail()">âœ•</button>
      </div>

      <div class="product-detail-body">
        <div class="product-detail-category" id="detailCategory"></div>
        <div class="product-detail-name" id="detailName"></div>
        <div class="product-detail-tag" id="detailTag"></div>
        <div class="product-detail-desc" id="detailDesc"></div>

        <div class="product-detail-prices">
          <div class="detail-price-main" id="detailPrice"></div>
          <div class="detail-price-old hidden" id="detailOldPrice"></div>
        </div>

        <div class="detail-qty-row">
          <span>Miqdor:</span>
          <div class="detail-qty-controls">
            <button id="detailQtyMinus">-</button>
            <span id="detailQtyValue">1</span>
            <button id="detailQtyPlus">+</button>
          </div>
        </div>

        <div class="detail-actions">
          <button class="detail-add-btn" id="detailAddBtn">ğŸ›’ Savatga qoâ€˜shish</button>
          <button class="detail-back-btn hidden" id="detailBackBtn">â—€ Qaytish</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast">Xabar</div>

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- App JS -->
  <script type="module" src="app.js"></script>

  <!-- AUTO UPDATE (WebApp yopilganda + ochilganda yangilanadi) -->
  <script>
    const tg = window.Telegram && window.Telegram.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
      tg.onEvent("viewportChanged", () => location.reload());
    }
  </script>

</body>
</html>
