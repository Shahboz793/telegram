<!doctype html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>Premium FastFood â€” Online buyurtma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />

  <!-- STYLE -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="page-wrap">
    <!-- HEADER -->
    <header class="app-header">
      <div class="logo-wrap">
        <div class="logo-circle">ğŸ”</div>
        <div class="logo-text">
          <div class="logo-title">Premium FastFood</div>
          <div class="logo-sub">Tez va qulay yetkazib berish</div>
        </div>
      </div>

      <div class="header-right">
        <!-- THEME TOGGLE -->
        <button id="themeToggleBtn" type="button" class="icon-btn">ğŸŒ™</button>

        <!-- CART TOP -->
        <button
          type="button"
          class="cart-top-btn"
          onclick="toggleCartSheet(true)">
          <span>ğŸ›’ Savat</span>
          <span class="pill"><span id="cartCountTop">0</span> ta</span>
          <span class="cart-top-total" id="cartTotalTop">0 soâ€˜m</span>
        </button>

        <!-- ADMIN -->
        <button id="adminAccessBtn" type="button" class="icon-btn">
          ğŸ‘‘ Admin uchun
        </button>

        <!-- KURYER PANELI (tez oâ€˜tish) -->
        <button
          type="button"
          class="icon-btn"
          onclick="location.href='courier.html'">
          ğŸšš
        </button>
      </div>
    </header>

    <!-- TABS -->
    <nav class="tabs" id="tabs">
      <button class="tab-btn active" data-page="shopPage">ğŸ½ Menyu</button>
      <button class="tab-btn" data-page="ordersPage">ğŸ“¦ Buyurtmalarim</button>
      <button class="tab-btn hidden" id="adminTabBtn" data-page="adminPage">
        ğŸ‘‘ Admin
      </button>
    </nav>

    <!-- === SHOP PAGE === -->
    <main>
      <section id="shopPage" class="page">
        <!-- MIJOZ PANELI -->
        <div class="customer-panel">
          <p id="customerInfoText" class="customer-info">
            Mijoz maâ€™lumotlari saqlanmagan. Buyurtma berganingizda ism va telefon soâ€˜raladi.
          </p>
          <div class="customer-actions">
            <button
              type="button"
              class="btn-outline"
              onclick="editCustomerInfo()">
              ğŸ‘¤ Maâ€™lumotni oâ€˜zgartirish
            </button>
            <button
              type="button"
              class="btn-ghost"
              onclick="resetCustomerInfo()">
              ğŸ§¹ Tozalash
            </button>
          </div>
        </div>

        <!-- QIDIRUV -->
        <div class="shop-toolbar">
          <input
            id="searchInput"
            class="search-input"
            type="search"
            placeholder="Qidirish: taom nomi, kategoriya, tavsif..."
          />
        </div>

        <!-- KATEGORIYA CHIPLARI -->
        <div id="filterBar" class="chips-row">
          <!-- JS orqali toâ€˜ldiriladi -->
        </div>

        <!-- MAHSULOTLAR GRID -->
        <section id="productsGrid" class="products-grid">
          <!-- JS orqali toâ€˜ldiriladi -->
        </section>
      </section>

      <!-- === BUYURTMALARIM PAGE === -->
      <section id="ordersPage" class="page hidden">
        <h2 class="section-title">ğŸ“¦ Buyurtmalarim</h2>
        <p class="section-sub">
          Oxirgi buyurtmalaringizni shu yerda kuzatib boring. Holati oâ€˜zgarganda sizga xabar chiqadi.
        </p>
        <div id="clientOrdersList" class="orders-list">
          <!-- JS orqali toâ€˜ldiriladi -->
        </div>
      </section>

      <!-- === ADMIN PAGE === -->
      <section id="adminPage" class="page hidden admin-page">
        <!-- ADMIN TOP BAR -->
        <header class="admin-top-bar">
          <h2 class="section-title">ğŸ‘‘ Admin paneli</h2>
          <div class="admin-top-actions">
            <!-- KURYER PANELIGA Oâ€˜TISH -->
            <button
              type="button"
              class="btn-xs btn-xs-secondary"
              onclick="location.href='courier.html'">
              ğŸšš Kuryer paneli
            </button>
          </div>
        </header>

        <div class="admin-cols">
          <!-- 1-KOLONKA: MAHSULOTLAR -->
          <div class="admin-col">
            <article class="card">
              <h3 class="card-title">ğŸ” Mahsulotlar</h3>
              <p class="card-sub">
                Yangi taom qoâ€˜shish, narxini oâ€˜zgartirish va rasm galereyasini boshqarish.
              </p>

              <div class="form-grid">
                <label>
                  Nomi
                  <input
                    id="adminName"
                    type="text"
                    placeholder="Masalan: Lavash Classic" />
                </label>

                <label>
                  Kategoriya
                  <select id="adminCategory">
                    <!-- JS orqali kategoriyalar tushadi -->
                  </select>
                </label>

                <label>
                  Asosiy narx (soâ€˜m)
                  <input
                    id="adminPriceBase"
                    type="number"
                    min="0"
                    placeholder="Masalan: 45000" />
                </label>

                <label class="checkbox-row">
                  <input
                    id="adminHasDiscount"
                    type="checkbox" />
                  Chegirma narxi bor
                </label>

                <label>
                  Chegirmali narx (soâ€˜m)
                  <input
                    id="adminPriceDiscount"
                    type="number"
                    min="0"
                    placeholder="Masalan: 39000" />
                </label>

                <label>
                  Tag / chip
                  <input
                    id="adminTag"
                    type="text"
                    placeholder="Masalan: Juda ommabop" />
                </label>

                <label>
                  Tavsif
                  <textarea
                    id="adminDescription"
                    placeholder="Taom tarkibi, porsiya hajmi va boshqalar..."></textarea>
                </label>

                <label>
                  Rasm nomlari yoki URL (vergul bilan)
                  <textarea
                    id="adminImages"
                    placeholder="masalan: lavash1, lavash1-2, https://..."></textarea>
                </label>
              </div>

              <button
                type="button"
                class="btn-primary btn-full admin-btn"
                onclick="addCustomProduct()">
                â• Mahsulotni qoâ€˜shish (Firestore)
              </button>

              <div id="adminCustomList" class="admin-list">
                <!-- JS orqali mahsulot roâ€˜yxati -->
              </div>
            </article>
          </div>

          <!-- 2-KOLONKA: KATEGORIYA + KURYER XARITASI -->
          <div class="admin-col">
            <!-- KATEGORIYA -->
            <article class="card">
              <h3 class="card-title">ğŸ· Kategoriyalar</h3>
              <p class="card-sub">
                Menyudagi boâ€˜limlarni (fastfood, ichimliklar va h.k.) sozlash.
              </p>

              <div class="form-grid">
                <label>
                  Kategoriya kodi (lotincha)
                  <input
                    id="adminCatCode"
                    type="text"
                    placeholder="masalan: lavash, burger" />
                </label>

                <label>
                  Kategoriya nomi
                  <input
                    id="adminCatLabel"
                    type="text"
                    placeholder="Masalan: Lavashlar" />
                </label>

                <label>
                  Emoji
                  <input
                    id="adminCatEmoji"
                    type="text"
                    placeholder="Masalan: ğŸŒ¯" />
                </label>
              </div>

              <button
                type="button"
                class="btn-primary btn-full admin-btn"
                onclick="saveCategory()">
                ğŸ’¾ Kategoriyani saqlash
              </button>

              <div id="adminCategoryList" class="admin-list">
                <!-- JS orqali kategoriyalar roâ€˜yxati -->
              </div>
            </article>

            <!-- KURYER XARITASI -->
            <article class="card">
              <h3 class="card-title">ğŸšš Kuryer xaritasi</h3>
              <p class="card-sub">
                Kuryerga berilgan va GPS bilan saqlangan buyurtmalarni koâ€˜rish.
              </p>

              <select id="courierOrderSelect" class="search-input">
                <option value="">Kuryerda buyurtma yoâ€˜q</option>
              </select>

              <div
                style="
                  margin-top:8px;
                  aspect-ratio:16/9;
                  border-radius:var(--radius);
                  overflow:hidden;
                  border:1px solid var(--border);
                ">
                <iframe
                  id="courierMapFrame"
                  src=""
                  width="100%"
                  height="100%"
                  style="border:0;">
                </iframe>
              </div>

              <div
                id="courierInfo"
                class="section-sub"
                style="margin-top:8px;">
                Kuryerga berilgan buyurtmani tanlang.
              </div>

              <div
                style="
                  margin-top:8px;
                  display:flex;
                  gap:8px;
                  flex-wrap:wrap;
                ">
                <button
                  type="button"
                  class="btn-xs btn-xs-secondary"
                  onclick="centerToCourier()">
                  ğŸ“ Marshrut tuzish
                </button>
                <button
                  type="button"
                  class="btn-xs btn-xs-secondary"
                  onclick="openSelectedCourierExternal()">
                  ğŸŒ Google Mapsâ€™da ochish
                </button>
              </div>
            </article>
          </div>

          <!-- 3-KOLONKA: BUYURTMALAR -->
          <div class="admin-col">
            <article class="card">
              <h3 class="card-title">ğŸ§¾ Buyurtmalar</h3>
              <p class="card-sub">
                Tasdiqlash, kuryerga berish, bekor qilish va yetkazib boâ€˜lingan
                buyurtmalarni boshqarish.
              </p>
              <div id="adminOrdersList" class="admin-list">
                <!-- JS orqali toâ€˜ldiriladi -->
              </div>
            </article>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- SAVAT BOTTOM SHEET -->
  <div
    id="cartSheetOverlay"
    class="overlay"
    onclick="toggleCartSheet(false)">
  </div>

  <aside id="cartSheet" class="cart-sheet">
    <header>
      <h2>ğŸ›’ Savat</h2>
      <button
        type="button"
        class="icon-btn"
        onclick="toggleCartSheet(false)">
        âœ•
      </button>
    </header>

    <div class="cart-sheet-total-row">
      Jami: <span id="cartSheetTotal">0 soâ€˜m</span>
    </div>

    <div id="cartItems">
      <!-- JS orqali toâ€˜ldiriladi -->
    </div>

    <button
      type="button"
      class="btn-primary btn-full"
      onclick="sendOrder()">
      ğŸ”¥ Buyurtma berish
    </button>
  </aside>

  <!-- EKRAN PASTIDA BUYURTMA BERISH TUGMASI -->
  <button
    id="quickOrderBtn"
    class="btn-primary btn-full hidden"
    style="
      position:fixed;
      left:50%;
      bottom:10px;
      transform:translateX(-50%);
      max-width:480px;
      z-index:80;
      text-align:center;
      display:flex;
      flex-direction:column;
      gap:3px;
    "
    onclick="sendOrder()">
    <span>ğŸ”¥ Buyurtma berish</span>
    <span style="font-size:11px;opacity:.9;">
      (Avval barcha mahsulotni tanlab, keyin shu tugmani bosing)
    </span>
  </button>

  <!-- TOAST -->
  <div id="toast" class="toast"></div>

  <!-- DING OVOZ (index bilan bir papkada ding.mp3 boâ€˜lsin) -->
  <audio id="notifySound" src="ding.mp3" preload="auto"></audio>

  <!-- APP SCRIPT -->
  <script type="module" src="app.js"></script>
</body>
</html>
