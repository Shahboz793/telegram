<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>Beauty Store â€” Kosmetika Doâ€˜koni</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />

  <!-- Asosiy CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Galereya va detal uchun qo'shimcha CSS (xohlasang style.css oxiriga ko'chirib qo'y) -->
  <style>
    /* ===== RASM GALEREYASI ===== */
    .gallery-overlay {
      position: fixed;
      inset: 0;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 1;
      visibility: visible;
      pointer-events: none;
    }
    .gallery-overlay.hidden {
      opacity: 0;
      visibility: hidden;
    }
    .gallery-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.88);
      backdrop-filter: blur(4px);
      pointer-events: auto;
    }
    .gallery-content {
      position: relative;
      max-width: 900px;
      width: 95%;
      max-height: 90vh;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: auto;
    }
    .gallery-image {
      max-width: 100%;
      max-height: 90vh;
      border-radius: 16px;
      object-fit: contain;
      box-shadow: 0 20px 60px rgba(0,0,0,0.7);
    }
    .gallery-close {
      position: absolute;
      top: 12px;
      right: 16px;
      border: none;
      background: rgba(15,23,42,0.8);
      color: #f9fafb;
      font-size: 18px;
      font-weight: 600;
      width: 32px;
      height: 32px;
      border-radius: 999px;
      cursor: pointer;
    }
    .gallery-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: rgba(15,23,42,0.7);
      color: #e5e7eb;
      font-size: 22px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .gallery-prev { left: 12px; }
    .gallery-next { right: 12px; }
    .gallery-counter {
      position: absolute;
      bottom: 12px;
      right: 16px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15,23,42,0.8);
      color: #e5e7eb;
      font-size: 12px;
    }
    body.no-scroll {
      overflow: hidden;
    }

    /* Detal pastidagi savat tugmalari */
    .detail-cart-actions {
      margin-top: 12px;
      display: flex;
      gap: 8px;
      justify-content: flex-start;
    }
    .detail-cart-actions.hidden {
      display: none;
    }
    .detail-cart-btn {
      flex: 1;
      padding: 8px 10px;
      border-radius: 999px;
      border: none;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s ease;
    }
    .detail-cart-btn.primary {
      background: linear-gradient(120deg, #22c55e, #16a34a);
      color: #f9fafb;
    }
    .detail-cart-btn.danger {
      background: #fee2e2;
      color: #b91c1c;
    }
    .detail-cart-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(15,23,42,0.18);
    }
  </style>
</head>

<body class="theme-light">
<div class="page">

  <!-- HEADER -->
  <header class="header">
    <div class="header-left">
      <div class="logo-circle">B</div>
      <div class="logo-text">
        <div class="logo-title">Beauty Store</div>
        <div class="logo-sub">Premium kosmetika doâ€˜koni</div>
      </div>
    </div>

    <div class="header-right">
      <button id="themeToggleBtn" class="icon-btn" aria-label="Theme toggle">ğŸŒ™</button>

      <button class="cart-top" onclick="toggleCartSheet()">
        <span class="cart-top-main">
          ğŸ§º Savat
          <span class="cart-top-count" id="cartCountTop">0</span>
        </span>
        <span class="cart-top-total" id="cartTotalTop">0 soâ€˜m</span>
      </button>

      <button id="adminAccessBtn" class="admin-acces-btn">ğŸ‘‘ Admin uchun</button>
    </div>
  </header>

  <!-- TABS -->
  <nav id="tabs" class="tabs">
    <button class="tab-btn active" data-page="shopPage">ğŸ› Doâ€˜kon</button>
    <button class="tab-btn" data-page="historyPage">ğŸ“œ Buyurtmalar tarixi</button>
    <button class="tab-btn hidden" id="adminTabBtn" data-page="adminPage">ğŸ‘‘ Admin panel</button>
  </nav>

  <!-- ASOSIY KONTENT -->
  <main class="main">

    <!-- SHOP PAGE -->
    <section id="shopPage">
      <div class="search-wrap">
        <input
          id="searchInput"
          type="search"
          placeholder="Mahsulot izlash (nomi, tur, tavsif)..."
          class="search-input"
        />
      </div>

      <!-- Kategoriya filterlari -->
      <div id="filterBar" class="filter-bar">
        <button class="chip active" data-category="all">ğŸ” Barchasi</button>
        <button class="chip" data-category="pomada">ğŸ’„ Pomada</button>
        <button class="chip" data-category="krem">ğŸ§´ Krem</button>
        <button class="chip" data-category="parfyum">ğŸŒ¸ Parfyum</button>
        <button class="chip" data-category="koâ€˜z">ğŸ‘ Koâ€˜z uchun</button>
        <button class="chip" data-category="tana">ğŸ› Tana / soch</button>
      </div>

      <!-- Mahsulot grid -->
      <div id="productsGrid" class="products-grid"></div>
    </section>

    <!-- HISTORY PAGE -->
    <section id="historyPage" class="hidden">
      <div class="page-title">ğŸ“œ Buyurtmalar tarixi</div>
      <div class="history-top">
        <button class="outline-btn" onclick="clearHistory()">ğŸ§¹ Tarixni tozalash</button>
      </div>
      <div id="historyList" class="history-list"></div>
    </section>

    <!-- ADMIN PAGE -->
    <section id="adminPage" class="hidden">
      <div class="page-title">ğŸ‘‘ Admin panel</div>

      <div class="admin-form">
        <h3>Mahsulot qoâ€˜shish / tahrirlash</h3>

        <label class="field">
          <span>Nomi</span>
          <input id="adminName" type="text" placeholder="Masalan: Mat pomada Nude Lux" />
        </label>

        <label class="field">
          <span>Kategoriya</span>
          <select id="adminCategory">
            <option value="pomada">Pomada / lab uchun</option>
            <option value="krem">Krem / yuz uchun</option>
            <option value="parfyum">Parfyum</option>
            <option value="niqob">Niqob / mask</option>
            <option value="koâ€˜z">Koâ€˜z uchun</option>
            <option value="tana">Tana / soch parvarishi</option>
          </select>
        </label>

        <label class="field">
          <span>Asosiy narx (soâ€˜m)</span>
          <input id="adminPriceBase" type="number" min="0" placeholder="Masalan: 99000" />
        </label>

        <label class="field field-inline">
          <span>
            <input id="adminHasDiscount" type="checkbox" />
            <span>Chegirma (eski narxni koâ€˜rsatish)</span>
          </span>
          <input id="adminPriceDiscount" type="number" min="0" placeholder="Chegirma narxi (ixtiyoriy)" />
        </label>

        <label class="field">
          <span>Tag / status (ixtiyoriy)</span>
          <input id="adminTag" type="text" placeholder="Masalan: Yangi kolleksiya, Best seller" />
        </label>

        <label class="field">
          <span>Tavsif</span>
          <textarea id="adminDescription" rows="3" placeholder="Mahsulot haqida qisqa ma'lumot"></textarea>
        </label>

        <label class="field">
          <span>Rasmlar (vergul bilan ajratib yozing)</span>
          <textarea id="adminImages" rows="2"
            placeholder="https://..., https://..., yoki faqat nomlar: pomada1, pomada1-2, ..."></textarea>
        </label>

        <button type="button" class="admin-btn" onclick="addCustomProduct()">
          â• Mahsulotni qoâ€˜shish (Firestore)
        </button>
      </div>

      <div class="admin-list">
        <p class="admin-list-title">Firestoreâ€™dagi mahsulotlar:</p>
        <div id="adminCustomList"></div>
      </div>
    </section>

  </main>

  <!-- CART BOTTOM SHEET -->
  <div id="cartSheetOverlay" class="cart-sheet-overlay"></div>
  <div id="cartSheet" class="cart-sheet">
    <div class="cart-sheet-header">
      <div>
        <strong>ğŸ§º Savat</strong>
        <div class="cart-sheet-sub">Tanlagan mahsulotlaringiz</div>
      </div>
      <button class="icon-btn" onclick="toggleCartSheet(false)">âœ•</button>
    </div>

    <div id="cartItems" class="cart-items"></div>

    <div class="cart-sheet-footer">
      <div class="cart-sheet-total-wrap">
        <span>Umumiy summa:</span>
        <strong id="cartSheetTotal">0 soâ€˜m</strong>
      </div>
      <button class="primary-btn" onclick="sendOrder()">ğŸ“© Telegram orqali buyurtma berish</button>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="toast"></div>

  <!-- MAHSULOT DETAIL OVERLAY -->
  <div id="productDetailOverlay" class="product-detail-overlay hidden">
    <div class="product-detail-backdrop"></div>
    <div class="product-detail-card">
      <div class="product-detail-img-wrap">
        <img id="detailImage" src="" alt="Mahsulot rasmi" class="product-detail-img" />
      </div>
      <div class="product-detail-body">
        <div class="product-detail-meta" id="detailCategory">Kategoriya</div>
        <h2 id="detailName" class="product-detail-name">Mahsulot nomi</h2>
        <div id="detailTag" class="product-detail-tag"></div>
        <p id="detailDesc" class="product-detail-desc">
          Mahsulot tavsifi shu yerda chiqadi.
        </p>

        <div class="product-detail-prices">
          <span id="detailPrice" class="product-detail-price">0 soâ€˜m</span>
          <span id="detailOldPrice" class="product-detail-price-old hidden"></span>
        </div>

        <button id="detailAddBtn" class="product-detail-add">
          ğŸ›’ Savatga qoâ€˜shish
        </button>

        <button id="detailBackBtn" class="outline-btn product-detail-back hidden">
          â¬… Asosiy sahifaga qaytish
        </button>

        <!-- Bu yerga savatni boshqarish tugmalarini qoâ€˜shdik -->
        <div id="detailCartActions" class="detail-cart-actions hidden">
          <button id="detailOpenCartBtn" class="detail-cart-btn primary">
            ğŸ§º Savatni koâ€˜rish
          </button>
          <button id="detailRemoveFromCartBtn" class="detail-cart-btn danger">
            âœ• Savatdan oâ€˜chirish
          </button>
        </div>

      </div>
    </div>
  </div>

  <!-- RASM GALEREYASI (FULLSCREEN) -->
  <div id="imageGalleryOverlay" class="gallery-overlay hidden">
    <div class="gallery-backdrop"></div>
    <div class="gallery-content">
      <button id="galleryCloseBtn" class="gallery-close">âœ•</button>

      <button id="galleryPrevBtn" class="gallery-nav gallery-prev">â€¹</button>

      <img id="galleryImage" src="" alt="Mahsulot rasmi" class="gallery-image" />

      <button id="galleryNextBtn" class="gallery-nav gallery-next">â€º</button>

      <div id="galleryCounter" class="gallery-counter">1 / 1</div>
    </div>
  </div>

</div>

<!-- APP.JS -->
<script type="module" src="app.js"></script>
</body>
</html>
