<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>ONLINE MAGAZIN YANGIOBOD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="theme-color" content="#0f172a" />

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- STYLE -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header-row">
      <div class="logo-wrap">
        <div class="logo-circle"><span>YM</span></div>
        <div class="logo-text">
          <strong>ONLINE MAGAZIN YANGIOBOD</strong>
          <small id="customerInfoText">Hozircha ism va telefon saqlanmagan.</small>
        </div>
      </div>

      <div class="header-right">
        <button class="theme-toggle" id="themeToggleBtn">ğŸŒ™</button>

        <button class="cart-icon-btn" onclick="toggleCartSheet(true)">
          <div class="cart-icon-left">ğŸ›’</div>
          <div class="cart-icon-info">
            <strong><span id="cartCountTop">0</span> ta</strong>
            <small id="cartTotalTop">0 soâ€˜m</small>
          </div>
        </button>

        <button class="admin-access" id="adminAccessBtn">ğŸ‘‘ Admin</button>
      </div>
    </div>

    <!-- TABS -->
    <div class="tabs" id="tabs">
      <button class="tab-btn active" data-page="shopPage">ğŸ› Magazin</button>
      <button class="tab-btn" data-page="historyPage">ğŸ“œ Tarix</button>
      <button class="tab-btn hidden" id="adminTabBtn" data-page="adminPage">âš™ï¸ Admin</button>
    </div>
  </header>


  <!-- SHOP PAGE -->
  <main id="shopPage">
    <section class="hero">
      <h1 class="hero-title">Tezkor <span>Telegram buyurtma</span></h1>
      <p class="hero-sub">Mahsulotlarni tanlang va barchasini Telegram orqali yuboring.</p>

      <div class="hero-badges">
        <div class="badge">âš¡ Tezkor</div>
        <div class="badge">ğŸ“¦ Savat</div>
        <div class="badge">ğŸ“² WebApp</div>
      </div>

      <div class="search-bar">
        <span>ğŸ”</span>
        <input id="searchInput" type="text" placeholder="Qidiring..." />
      </div>
    </section>

    <!-- FILTER -->
    <div class="filters-wrapper">
      <div class="filters" id="filterBar"></div>
    </div>

    <!-- PRODUCTS GRID -->
    <section class="products-wrap">
      <div class="products-grid big" id="productsGrid">
        <!-- JS bilan toâ€˜ladi -->
      </div>
    </section>
  </main>


  <!-- HISTORY PAGE -->
  <section id="historyPage" class="page hidden">
    <h2 class="page-title">ğŸ“œ Buyurtmalar tarixi</h2>
    <p class="page-sub">Buyurtmalar tarixini saqlamaymiz.</p>
    <button class="clear-history-btn" onclick="clearHistory()">Tarixni tozalash</button>
    <div id="historyList"></div>
  </section>


  <!-- ADMIN PAGE -->
  <section id="adminPage" class="page hidden">
    <h2 class="page-title">âš™ï¸ Admin panel</h2>

    <!-- PRODUCT FORM -->
    <div class="admin-form">
      <h3>â• Mahsulot qoâ€˜shish / tahrirlash</h3>

      <div class="form-row">
        <label>Mahsulot nomi</label>
        <input id="adminName" type="text" placeholder="Masalan: Parfyum X" />
      </div>

      <div class="form-row">
        <label>Kategoriya</label>
        <select id="adminCategory"></select>
      </div>

      <div class="form-row">
        <label>Asosiy narx</label>
        <input id="adminPriceBase" type="number" />
      </div>

      <div class="admin-check-row">
        <input id="adminHasDiscount" type="checkbox" />
        <label>Chegirma bor</label>
      </div>

      <div class="form-row">
        <label>Chegirma narxi</label>
        <input id="adminPriceDiscount" type="number" />
      </div>

      <div class="form-row">
        <label>Tag</label>
        <input id="adminTag" type="text" placeholder="Yangi, Bestseller..." />
      </div>

      <div class="form-row">
        <label>Tavsif</label>
        <textarea id="adminDescription"></textarea>
      </div>

      <div class="form-row">
        <label>Rasmlar (vergul bilan)</label>
        <input id="adminImages" type="text" />
      </div>

      <button class="admin-btn" onclick="addCustomProduct()">ğŸ’¾ Saqlash</button>
    </div>

    <h3 class="admin-list-title">ğŸ§¾ Mahsulotlar</h3>
    <div id="adminCustomList"></div>

    <h3 class="admin-list-title" style="margin-top:18px;">ğŸ“ Kategoriyalar</h3>

    <div class="admin-form">
      <div class="form-row">
        <label>Kod</label>
        <input id="adminCatCode" type="text" />
      </div>
      <div class="form-row">
        <label>Nom</label>
        <input id="adminCatLabel" type="text" />
      </div>
      <div class="form-row">
        <label>Emoji</label>
        <input id="adminCatEmoji" type="text" />
      </div>
      <button class="admin-btn" onclick="saveCategory()">Saqlash</button>
    </div>

    <div id="adminCategoryList"></div>
  </section>


  <!-- CART OVERLAY -->
  <div class="sheet-overlay" id="cartSheetOverlay" onclick="toggleCartSheet(false)"></div>

  <div class="cart-sheet" id="cartSheet">
    <div class="cart-sheet-header">
      <h3>Savat</h3>
      <button onclick="toggleCartSheet(false)">âœ•</button>
    </div>

    <div class="cart-sheet-body" id="cartItems"></div>

    <div class="cart-sheet-footer">
      <div class="cart-sheet-footer-top">
        <span>Umumiy</span>
        <strong id="cartSheetTotal">0 soâ€˜m</strong>
      </div>

      <button class="cart-sheet-btn" onclick="sendOrder()">ğŸ“² Telegramda tasdiqlash</button>
    </div>
  </div>


  <!-- PRODUCT DETAIL -->
  <div class="product-detail-overlay hidden" id="productDetailOverlay">
    <div class="product-detail-card">
      <div class="product-detail-header">
        <img id="detailImage" />

        <button class="detail-gallery-btn left" id="detailPrevBtn">â€¹</button>
        <button class="detail-gallery-btn right" id="detailNextBtn">â€º</button>

        <button class="product-detail-close" onclick="closeProductDetail()">âœ•</button>
      </div>

      <div class="product-detail-body">
        <div id="detailCategory" class="product-detail-category"></div>
        <div id="detailName" class="product-detail-name"></div>
        <div id="detailTag" class="product-detail-tag"></div>
        <div id="detailDesc" class="product-detail-desc"></div>

        <div class="product-detail-prices">
          <div id="detailPrice" class="detail-price-main"></div>
          <div id="detailOldPrice" class="detail-price-old hidden"></div>
        </div>

        <div class="detail-actions">
          <button id="detailAddBtn" class="detail-add-btn">ğŸ›’ Savatga qoâ€˜shish</button>
        </div>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div class="toast" id="toast">Xabar</div>

  <!-- Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- App JS -->
  <script type="module" src="app.js"></script>

  <!-- Mirror bar helper -->
  <script>
    const cartCountTop = document.getElementById("cartCountTop");
    const cartTotalTop = document.getElementById("cartTotalTop");
    const cartCountTopMirror = document.getElementById("cartCountTopMirror");
    const cartTotalTopMirror = document.getElementById("cartTotalTopMirror");
  </script>

</body>
</html>
